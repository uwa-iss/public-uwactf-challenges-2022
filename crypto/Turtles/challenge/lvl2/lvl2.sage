from Crypto.Util.number import getPrime, bytes_to_long, long_to_bytes, inverse
from math import gcd

nbits = 1024

p = getPrime(nbits)
q = getPrime(nbits)
n = p*q

e1 = getPrime(nbits//(2**7))
e2 = getPrime(nbits//(2**7))

m = bytes_to_long(b"password: EnT0n6cl927t9BkU")

c1 = pow(m, e1, n)
c2 = pow(m, e2, n)

print(f"n: {n}")
print(f"e1: {e1}")
print(f"e2: {e2}")
print(f"c1: {c1}")
print(f"c2: {c2}")

assert gcd(e1, e2) == 1
assert gcd(c2, n) == 1

s1 = inverse(e1, e2)
s2 = (gcd(e1, e2)-e1*s1) // e2
temp = inverse(c2, n)
m1 = pow(c1, s1, n)
m2 = pow(temp, -s2, n)
pt = (m1 * m2) % n
print(long_to_bytes(pt))

#n: 27390742047211866210026944369743887414566458029516514425033626306774494689864174495801555272383190583160082989655863312205047053183692830244256178957626107376560379967207985126156190858536517205268949994460850754539444809410585157088177071636502330471866361668190182789076443134992817065067251833360182098260126782731885535313311335548973261364561399048355594884908144981171535890330075378020662433636919739225721250388595210241180516033224412865027892600445056035076813797868459879508284740398056781703117842217915374745944665788538529937708042475610187926079841899148576087451377023173071901473591091933937339958843
#e1: 223
#e2: 179
#c1: 26340747778274532766654862748934907641190238831811510416009409348800652359726766791764494117241998650220107492130551055000787536016073648842930661114117853728852033281438609968901796733493973916793475324249548236759154306078379633384886324645602605919981445076258410042190761801406183116358063628177474671044832335760453353873545921040502393107138826827934173828094473127840644522350331873044252353800612552493014143210237904066669883473056610510105777414940005672845193809024250242037882266795778313266209653971406373124342755351866738190064905242404359384377276182001226959012983433085848632602613634696841430256175
#c2: 22519899019163493297221998432752837612694554920681179747605507328287724627960960551384407172088512007451332408885600804890721939370945699733500438976316571609893007875322045832763871141110338906136148425452606887793726153592740012191386168144802034521554966114121888428565319696414617652880234413434888643068344029509749340173265319294969396207282433666543481682857610827618104948921088864616059004881776628539686343477394364143247139128538886076500284836802659205518831799351233904797123120460045480070210088914254770267568405332367121863450478149756863459522399462894899667321110126638386593999683207083396822904703
