from Crypto.Util.number import getPrime, bytes_to_long
from math import sqrt
from sage.all import *


def isprime(num):
    a=2
    while a<=sqrt(num):
        if num%a<1:
            return False
        a=a+1
    return num>1


nbits = 2048

p = getPrime(nbits)
q = getPrime(nbits)

n = p*q

assert p != q

m = bytes_to_long(b"password: U6i63O1mr7P0dr2u")

for e in range(0, 1000):
    if isprime(e):
        if m**e < n:
            c = pow(m, e, n)
            if Integer(c).nth_root(Integer(e)) == m:
                print(f"n: {n}")
                print(f"e: {e}")
                print(f"c: {c}")

#n: 429272348506533423061298506843311422890654431293209941815257350809952454925687209144914412008423605801547009857478099940293024254030120399475743610147821834053600245267463391660289543373645233764610287703860512881518675117273000991170049112692572937109940810437046575663648820732785022618241346986919472626098353940913271081367815091968852126898478862158945570112864445574135104904440373267548424756577351721919007606195646897407900491546480142362538392792167118776607053898641012520060112731914201847429157610882702744186205058919979104384726888861560830711978664898926390553519692869639523152804097992586550735868653253658323216808298455207154341169899081727665188368852407180228642184807348612697577562259351632150800278144695923625732462381691672384728011909616140671495643746805358790888359812931918289053100957424194705741476532486770229590714753588202941615237355763592236238305571085538458253785232118012377084516920059823964490966257074871916944319101456873960008292044139291429157494700926530773889508552032458617164187448640653762915875046825157652548497776548247761947334813252241313853342090469332943999201841600633308739858876319398985598765239947405389720912411778557765727569190077799390963468095042038413471394170779
#e: 19
#c: 7535708508535600828689737825679727572912929250423280472405392824596219626552190652036251131199448768697481309008030829759531585319043635401505342258560211699487953918733370304959044209432155969600716988883392964611632676060540491460321947655804410767957289396605059848126550283620860062275584452179405797362011643716408910515900336947308830056894874421944819174426107795373924044310864538001663383552488166560015325997093629383787806199805290632599989182599665857824680873154070014685282926577102537702511944806849948370251523064522385239907432090613460069894321420188625059177168121304796601704809881832734623965931285945198411385585774496844632591545159855498066452909241105181018326622622274011690803239326816445287127246084792259646274625318027207046501240677105221234534535418728038963384696588240743111178902077422943351983055091087108794743761363500696972394280937181622496780410622411990209602979186830418790637940123764151278142859107975001006519495420273684746460257772191683421620442532309072598041487521508765502134242280798025187846902973182088643220670736958271740562864588615368706331719983120236163343593263978539555166414649621684701880379665500087516474264789240333
