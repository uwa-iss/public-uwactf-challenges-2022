

# This file was *autogenerated* from the file ../../../../../crypto/Turtles/solution/solve.sage
from sage.all_cmdline import *   # import sage library

_sage_const_1 = Integer(1); _sage_const_4 = Integer(4); _sage_const_2 = Integer(2); _sage_const_0 = Integer(0); _sage_const_7612897926387454493341430837467857279730676296553431537405133241990350630072291775121226563164319034893479777163804734430079422292949165270056591769307673 = Integer(7612897926387454493341430837467857279730676296553431537405133241990350630072291775121226563164319034893479777163804734430079422292949165270056591769307673); _sage_const_65537 = Integer(65537); _sage_const_6735329377161533753045510067010928595289070183811762224631644533356638863259468753329942896694117248719244432246176344503968411657701661762113752718311014 = Integer(6735329377161533753045510067010928595289070183811762224631644533356638863259468753329942896694117248719244432246176344503968411657701661762113752718311014); _sage_const_25638625885319775965134362575286609665018069876127243141708859563947963506345166000913089539562695408270410537668353164005233052027768210097686073362167298102004921337988369769077943434611654323487631150202171950159041619523201223538635533954006798623676749912382552105532616294540415184166845180342406513231216843960096817132541606787502046463462998420193608208742068530407161665115049317807336433182358850212846045523555740305614515717256157320605225958989195148384827415694919028591028785902238803734527551825108527126474021519415361543504983859110014753294061708531006442296624870723745950476187413041953853799567 = Integer(25638625885319775965134362575286609665018069876127243141708859563947963506345166000913089539562695408270410537668353164005233052027768210097686073362167298102004921337988369769077943434611654323487631150202171950159041619523201223538635533954006798623676749912382552105532616294540415184166845180342406513231216843960096817132541606787502046463462998420193608208742068530407161665115049317807336433182358850212846045523555740305614515717256157320605225958989195148384827415694919028591028785902238803734527551825108527126474021519415361543504983859110014753294061708531006442296624870723745950476187413041953853799567); _sage_const_17256810588695599111470182447677557898705177769995297959937780439801976956014227155888547938549879608386503631864465827875010024167091534429401139635502450437619449843986450480739351279372639471516633554619913078968926267806671802782622514997768288685720474487096449642409362724816298930139671366087621687321524727929282122833059682164881625350621252994467137761677731594656792649883523309355002194233164134211211849819622506696387581857506339672595602429295184165770215980087815530856075134691963824793237334185094098645481554938043999365202550960066236681846687069087421484310386085854329653659710717217020879154447 = Integer(17256810588695599111470182447677557898705177769995297959937780439801976956014227155888547938549879608386503631864465827875010024167091534429401139635502450437619449843986450480739351279372639471516633554619913078968926267806671802782622514997768288685720474487096449642409362724816298930139671366087621687321524727929282122833059682164881625350621252994467137761677731594656792649883523309355002194233164134211211849819622506696387581857506339672595602429295184165770215980087815530856075134691963824793237334185094098645481554938043999365202550960066236681846687069087421484310386085854329653659710717217020879154447); _sage_const_23576840977636837062476096013917453976212574428676925267390057344522693058641318651919981732808344144451726785132238623390735570347503865501128268996774276055138361725389337013172076517947366549102767573131996421730655667358772907454589453951707773168273816777245167397985816797548342549238480936098306952223425750079637643836563758720657290017901271507347805047918276389516777304011340400265914913367459877478513392772595363611962731215873703047230075925791505139200437933230191758890679737105663798025511413498083166838293303146617526581144898345379293348543866073601449271405995489434762215203021179014217097354626 = Integer(23576840977636837062476096013917453976212574428676925267390057344522693058641318651919981732808344144451726785132238623390735570347503865501128268996774276055138361725389337013172076517947366549102767573131996421730655667358772907454589453951707773168273816777245167397985816797548342549238480936098306952223425750079637643836563758720657290017901271507347805047918276389516777304011340400265914913367459877478513392772595363611962731215873703047230075925791505139200437933230191758890679737105663798025511413498083166838293303146617526581144898345379293348543866073601449271405995489434762215203021179014217097354626); _sage_const_429272348506533423061298506843311422890654431293209941815257350809952454925687209144914412008423605801547009857478099940293024254030120399475743610147821834053600245267463391660289543373645233764610287703860512881518675117273000991170049112692572937109940810437046575663648820732785022618241346986919472626098353940913271081367815091968852126898478862158945570112864445574135104904440373267548424756577351721919007606195646897407900491546480142362538392792167118776607053898641012520060112731914201847429157610882702744186205058919979104384726888861560830711978664898926390553519692869639523152804097992586550735868653253658323216808298455207154341169899081727665188368852407180228642184807348612697577562259351632150800278144695923625732462381691672384728011909616140671495643746805358790888359812931918289053100957424194705741476532486770229590714753588202941615237355763592236238305571085538458253785232118012377084516920059823964490966257074871916944319101456873960008292044139291429157494700926530773889508552032458617164187448640653762915875046825157652548497776548247761947334813252241313853342090469332943999201841600633308739858876319398985598765239947405389720912411778557765727569190077799390963468095042038413471394170779 = Integer(429272348506533423061298506843311422890654431293209941815257350809952454925687209144914412008423605801547009857478099940293024254030120399475743610147821834053600245267463391660289543373645233764610287703860512881518675117273000991170049112692572937109940810437046575663648820732785022618241346986919472626098353940913271081367815091968852126898478862158945570112864445574135104904440373267548424756577351721919007606195646897407900491546480142362538392792167118776607053898641012520060112731914201847429157610882702744186205058919979104384726888861560830711978664898926390553519692869639523152804097992586550735868653253658323216808298455207154341169899081727665188368852407180228642184807348612697577562259351632150800278144695923625732462381691672384728011909616140671495643746805358790888359812931918289053100957424194705741476532486770229590714753588202941615237355763592236238305571085538458253785232118012377084516920059823964490966257074871916944319101456873960008292044139291429157494700926530773889508552032458617164187448640653762915875046825157652548497776548247761947334813252241313853342090469332943999201841600633308739858876319398985598765239947405389720912411778557765727569190077799390963468095042038413471394170779); _sage_const_19 = Integer(19); _sage_const_7535708508535600828689737825679727572912929250423280472405392824596219626552190652036251131199448768697481309008030829759531585319043635401505342258560211699487953918733370304959044209432155969600716988883392964611632676060540491460321947655804410767957289396605059848126550283620860062275584452179405797362011643716408910515900336947308830056894874421944819174426107795373924044310864538001663383552488166560015325997093629383787806199805290632599989182599665857824680873154070014685282926577102537702511944806849948370251523064522385239907432090613460069894321420188625059177168121304796601704809881832734623965931285945198411385585774496844632591545159855498066452909241105181018326622622274011690803239326816445287127246084792259646274625318027207046501240677105221234534535418728038963384696588240743111178902077422943351983055091087108794743761363500696972394280937181622496780410622411990209602979186830418790637940123764151278142859107975001006519495420273684746460257772191683421620442532309072598041487521508765502134242280798025187846902973182088643220670736958271740562864588615368706331719983120236163343593263978539555166414649621684701880379665500087516474264789240333 = Integer(7535708508535600828689737825679727572912929250423280472405392824596219626552190652036251131199448768697481309008030829759531585319043635401505342258560211699487953918733370304959044209432155969600716988883392964611632676060540491460321947655804410767957289396605059848126550283620860062275584452179405797362011643716408910515900336947308830056894874421944819174426107795373924044310864538001663383552488166560015325997093629383787806199805290632599989182599665857824680873154070014685282926577102537702511944806849948370251523064522385239907432090613460069894321420188625059177168121304796601704809881832734623965931285945198411385585774496844632591545159855498066452909241105181018326622622274011690803239326816445287127246084792259646274625318027207046501240677105221234534535418728038963384696588240743111178902077422943351983055091087108794743761363500696972394280937181622496780410622411990209602979186830418790637940123764151278142859107975001006519495420273684746460257772191683421620442532309072598041487521508765502134242280798025187846902973182088643220670736958271740562864588615368706331719983120236163343593263978539555166414649621684701880379665500087516474264789240333); _sage_const_27390742047211866210026944369743887414566458029516514425033626306774494689864174495801555272383190583160082989655863312205047053183692830244256178957626107376560379967207985126156190858536517205268949994460850754539444809410585157088177071636502330471866361668190182789076443134992817065067251833360182098260126782731885535313311335548973261364561399048355594884908144981171535890330075378020662433636919739225721250388595210241180516033224412865027892600445056035076813797868459879508284740398056781703117842217915374745944665788538529937708042475610187926079841899148576087451377023173071901473591091933937339958843 = Integer(27390742047211866210026944369743887414566458029516514425033626306774494689864174495801555272383190583160082989655863312205047053183692830244256178957626107376560379967207985126156190858536517205268949994460850754539444809410585157088177071636502330471866361668190182789076443134992817065067251833360182098260126782731885535313311335548973261364561399048355594884908144981171535890330075378020662433636919739225721250388595210241180516033224412865027892600445056035076813797868459879508284740398056781703117842217915374745944665788538529937708042475610187926079841899148576087451377023173071901473591091933937339958843); _sage_const_223 = Integer(223); _sage_const_179 = Integer(179); _sage_const_26340747778274532766654862748934907641190238831811510416009409348800652359726766791764494117241998650220107492130551055000787536016073648842930661114117853728852033281438609968901796733493973916793475324249548236759154306078379633384886324645602605919981445076258410042190761801406183116358063628177474671044832335760453353873545921040502393107138826827934173828094473127840644522350331873044252353800612552493014143210237904066669883473056610510105777414940005672845193809024250242037882266795778313266209653971406373124342755351866738190064905242404359384377276182001226959012983433085848632602613634696841430256175 = Integer(26340747778274532766654862748934907641190238831811510416009409348800652359726766791764494117241998650220107492130551055000787536016073648842930661114117853728852033281438609968901796733493973916793475324249548236759154306078379633384886324645602605919981445076258410042190761801406183116358063628177474671044832335760453353873545921040502393107138826827934173828094473127840644522350331873044252353800612552493014143210237904066669883473056610510105777414940005672845193809024250242037882266795778313266209653971406373124342755351866738190064905242404359384377276182001226959012983433085848632602613634696841430256175); _sage_const_22519899019163493297221998432752837612694554920681179747605507328287724627960960551384407172088512007451332408885600804890721939370945699733500438976316571609893007875322045832763871141110338906136148425452606887793726153592740012191386168144802034521554966114121888428565319696414617652880234413434888643068344029509749340173265319294969396207282433666543481682857610827618104948921088864616059004881776628539686343477394364143247139128538886076500284836802659205518831799351233904797123120460045480070210088914254770267568405332367121863450478149756863459522399462894899667321110126638386593999683207083396822904703 = Integer(22519899019163493297221998432752837612694554920681179747605507328287724627960960551384407172088512007451332408885600804890721939370945699733500438976316571609893007875322045832763871141110338906136148425452606887793726153592740012191386168144802034521554966114121888428565319696414617652880234413434888643068344029509749340173265319294969396207282433666543481682857610827618104948921088864616059004881776628539686343477394364143247139128538886076500284836802659205518831799351233904797123120460045480070210088914254770267568405332367121863450478149756863459522399462894899667321110126638386593999683207083396822904703); _sage_const_8488738333906402768184424303931319186937846354564498723225833198568658746612032320278568274199273168754874791886017553509671995405297044570379263394807675828948730941585892381937934974164461367350399020295544322652241314015612619952854122512360711158703276504576637980216542517131121821244413733317803612527098150050244106175075042363925415850904273713330610637797039073210153212406947693305199451883342171064289868467763520178192263996810236611412110114964094567843147988149403502201012221501784765567631635728635654552008940095240762014109309703431927276040000461554824748039435972011043716781928678118057249081937 = Integer(8488738333906402768184424303931319186937846354564498723225833198568658746612032320278568274199273168754874791886017553509671995405297044570379263394807675828948730941585892381937934974164461367350399020295544322652241314015612619952854122512360711158703276504576637980216542517131121821244413733317803612527098150050244106175075042363925415850904273713330610637797039073210153212406947693305199451883342171064289868467763520178192263996810236611412110114964094567843147988149403502201012221501784765567631635728635654552008940095240762014109309703431927276040000461554824748039435972011043716781928678118057249081937); _sage_const_3 = Integer(3); _sage_const_2203492093082380953201573988004010408254700540512875229186072008602268434623745039909552457544080958162582115769732896194963860518025291775984071313736715732781122794691004156623887816004267778546715233287739049892179284869968616654679000 = Integer(2203492093082380953201573988004010408254700540512875229186072008602268434623745039909552457544080958162582115769732896194963860518025291775984071313736715732781122794691004156623887816004267778546715233287739049892179284869968616654679000); _sage_const_2203492093082380953201573988004010408254700540512875229186072008602268434623842067583381437191968969220270105412130787148302528786381716219732676843705885137233567578564806221258291496061769609198725279749641014993505432043487303203612541 = Integer(2203492093082380953201573988004010408254700540512875229186072008602268434623842067583381437191968969220270105412130787148302528786381716219732676843705885137233567578564806221258291496061769609198725279749641014993505432043487303203612541); _sage_const_131 = Integer(131); _sage_const_137 = Integer(137); _sage_const_139 = Integer(139); _sage_const_149 = Integer(149); _sage_const_151 = Integer(151); _sage_const_157 = Integer(157); _sage_const_163 = Integer(163); _sage_const_167 = Integer(167); _sage_const_173 = Integer(173); _sage_const_181 = Integer(181); _sage_const_191 = Integer(191); _sage_const_193 = Integer(193); _sage_const_197 = Integer(197); _sage_const_199 = Integer(199); _sage_const_211 = Integer(211); _sage_const_227 = Integer(227); _sage_const_229 = Integer(229); _sage_const_233 = Integer(233); _sage_const_239 = Integer(239); _sage_const_241 = Integer(241); _sage_const_251 = Integer(251)
from Crypto.Util.number import long_to_bytes, inverse
import math
from sage.all import *

def wiener(n, e):
    """Wiener's attack"""
    n = Integer(n)
    e = Integer(e)
    for f in (e / n).continued_fraction().convergents()[_sage_const_1 :]:
        k, d = f.numerator(), f.denominator()
        phi = ((e * d) - _sage_const_1 ) / k
        b = -(n - phi + _sage_const_1 )
        dis_sqrt = sqrt(b * b - _sage_const_4  * n)
        if dis_sqrt.is_integer():
            p = (-b + dis_sqrt) / _sage_const_2 
            q = (-b - dis_sqrt) / _sage_const_2 
            if p < q:
                p, q = q, p
            return (d)


def franklinReiter(n,e,r,c1,c2):
    R = Zmod(n)['X']; (X,) = R._first_ngens(1)
    f1 = X**e - c1
    f2 = (X + r)**e - c2
    return Integer(n-(compositeModulusGCD(f1,f2)).coefficients()[_sage_const_0 ])

def compositeModulusGCD(a, b):
    if(b == _sage_const_0 ):
        return a.monic()
    else:
        return compositeModulusGCD(b, a % b)

def lvl1():
    n = _sage_const_7612897926387454493341430837467857279730676296553431537405133241990350630072291775121226563164319034893479777163804734430079422292949165270056591769307673 
    e = _sage_const_65537 
    c = _sage_const_6735329377161533753045510067010928595289070183811762224631644533356638863259468753329942896694117248719244432246176344503968411657701661762113752718311014 

    phi = n-_sage_const_1 

    d = inverse(e, phi)

    m = long_to_bytes(int(pow(c, d, n))).decode()

    return(m)

def lvl2():
    n = _sage_const_25638625885319775965134362575286609665018069876127243141708859563947963506345166000913089539562695408270410537668353164005233052027768210097686073362167298102004921337988369769077943434611654323487631150202171950159041619523201223538635533954006798623676749912382552105532616294540415184166845180342406513231216843960096817132541606787502046463462998420193608208742068530407161665115049317807336433182358850212846045523555740305614515717256157320605225958989195148384827415694919028591028785902238803734527551825108527126474021519415361543504983859110014753294061708531006442296624870723745950476187413041953853799567 
    e = _sage_const_17256810588695599111470182447677557898705177769995297959937780439801976956014227155888547938549879608386503631864465827875010024167091534429401139635502450437619449843986450480739351279372639471516633554619913078968926267806671802782622514997768288685720474487096449642409362724816298930139671366087621687321524727929282122833059682164881625350621252994467137761677731594656792649883523309355002194233164134211211849819622506696387581857506339672595602429295184165770215980087815530856075134691963824793237334185094098645481554938043999365202550960066236681846687069087421484310386085854329653659710717217020879154447 
    c = _sage_const_23576840977636837062476096013917453976212574428676925267390057344522693058641318651919981732808344144451726785132238623390735570347503865501128268996774276055138361725389337013172076517947366549102767573131996421730655667358772907454589453951707773168273816777245167397985816797548342549238480936098306952223425750079637643836563758720657290017901271507347805047918276389516777304011340400265914913367459877478513392772595363611962731215873703047230075925791505139200437933230191758890679737105663798025511413498083166838293303146617526581144898345379293348543866073601449271405995489434762215203021179014217097354626 
    d = wiener(n, e)

    if d is None:
        exit("Failed")

    m = pow(c, d, n)
    return(long_to_bytes(int(m)).decode())

def lvl3():
    n = _sage_const_429272348506533423061298506843311422890654431293209941815257350809952454925687209144914412008423605801547009857478099940293024254030120399475743610147821834053600245267463391660289543373645233764610287703860512881518675117273000991170049112692572937109940810437046575663648820732785022618241346986919472626098353940913271081367815091968852126898478862158945570112864445574135104904440373267548424756577351721919007606195646897407900491546480142362538392792167118776607053898641012520060112731914201847429157610882702744186205058919979104384726888861560830711978664898926390553519692869639523152804097992586550735868653253658323216808298455207154341169899081727665188368852407180228642184807348612697577562259351632150800278144695923625732462381691672384728011909616140671495643746805358790888359812931918289053100957424194705741476532486770229590714753588202941615237355763592236238305571085538458253785232118012377084516920059823964490966257074871916944319101456873960008292044139291429157494700926530773889508552032458617164187448640653762915875046825157652548497776548247761947334813252241313853342090469332943999201841600633308739858876319398985598765239947405389720912411778557765727569190077799390963468095042038413471394170779 
    e = _sage_const_19 
    c = _sage_const_7535708508535600828689737825679727572912929250423280472405392824596219626552190652036251131199448768697481309008030829759531585319043635401505342258560211699487953918733370304959044209432155969600716988883392964611632676060540491460321947655804410767957289396605059848126550283620860062275584452179405797362011643716408910515900336947308830056894874421944819174426107795373924044310864538001663383552488166560015325997093629383787806199805290632599989182599665857824680873154070014685282926577102537702511944806849948370251523064522385239907432090613460069894321420188625059177168121304796601704809881832734623965931285945198411385585774496844632591545159855498066452909241105181018326622622274011690803239326816445287127246084792259646274625318027207046501240677105221234534535418728038963384696588240743111178902077422943351983055091087108794743761363500696972394280937181622496780410622411990209602979186830418790637940123764151278142859107975001006519495420273684746460257772191683421620442532309072598041487521508765502134242280798025187846902973182088643220670736958271740562864588615368706331719983120236163343593263978539555166414649621684701880379665500087516474264789240333 

    return(long_to_bytes(Integer(c).nth_root(Integer(e))).decode())

def lvl4():
    n = _sage_const_27390742047211866210026944369743887414566458029516514425033626306774494689864174495801555272383190583160082989655863312205047053183692830244256178957626107376560379967207985126156190858536517205268949994460850754539444809410585157088177071636502330471866361668190182789076443134992817065067251833360182098260126782731885535313311335548973261364561399048355594884908144981171535890330075378020662433636919739225721250388595210241180516033224412865027892600445056035076813797868459879508284740398056781703117842217915374745944665788538529937708042475610187926079841899148576087451377023173071901473591091933937339958843 
    e1 = _sage_const_223 
    e2 = _sage_const_179 
    c1 = _sage_const_26340747778274532766654862748934907641190238831811510416009409348800652359726766791764494117241998650220107492130551055000787536016073648842930661114117853728852033281438609968901796733493973916793475324249548236759154306078379633384886324645602605919981445076258410042190761801406183116358063628177474671044832335760453353873545921040502393107138826827934173828094473127840644522350331873044252353800612552493014143210237904066669883473056610510105777414940005672845193809024250242037882266795778313266209653971406373124342755351866738190064905242404359384377276182001226959012983433085848632602613634696841430256175 
    c2 = _sage_const_22519899019163493297221998432752837612694554920681179747605507328287724627960960551384407172088512007451332408885600804890721939370945699733500438976316571609893007875322045832763871141110338906136148425452606887793726153592740012191386168144802034521554966114121888428565319696414617652880234413434888643068344029509749340173265319294969396207282433666543481682857610827618104948921088864616059004881776628539686343477394364143247139128538886076500284836802659205518831799351233904797123120460045480070210088914254770267568405332367121863450478149756863459522399462894899667321110126638386593999683207083396822904703 


    assert gcd(e1, e2) == _sage_const_1 
    assert gcd(c2, n) == _sage_const_1 

    s1 = inverse(e1, e2)
    s2 = (gcd(e1, e2)-e1*s1) // e2

    temp = inverse(c2, n)

    m1 = pow(c1, s1, n)
    m2 = pow(temp, -s2, n)

    pt = (m1 * m2) % n

    return(long_to_bytes(int(pt)).decode())

def lvl5():
    n = _sage_const_8488738333906402768184424303931319186937846354564498723225833198568658746612032320278568274199273168754874791886017553509671995405297044570379263394807675828948730941585892381937934974164461367350399020295544322652241314015612619952854122512360711158703276504576637980216542517131121821244413733317803612527098150050244106175075042363925415850904273713330610637797039073210153212406947693305199451883342171064289868467763520178192263996810236611412110114964094567843147988149403502201012221501784765567631635728635654552008940095240762014109309703431927276040000461554824748039435972011043716781928678118057249081937 
    e = _sage_const_3 
    c1 = _sage_const_2203492093082380953201573988004010408254700540512875229186072008602268434623745039909552457544080958162582115769732896194963860518025291775984071313736715732781122794691004156623887816004267778546715233287739049892179284869968616654679000 
    c2 = _sage_const_2203492093082380953201573988004010408254700540512875229186072008602268434623842067583381437191968969220270105412130787148302528786381716219732676843705885137233567578564806221258291496061769609198725279749641014993505432043487303203612541 
    primes = [_sage_const_131 , _sage_const_137 , _sage_const_139 , _sage_const_149 , _sage_const_151 , _sage_const_157 , _sage_const_163 , _sage_const_167 , _sage_const_173 , _sage_const_179 , _sage_const_181 , _sage_const_191 , _sage_const_193 , _sage_const_197 , _sage_const_199 , _sage_const_211 , _sage_const_223 , _sage_const_227 , _sage_const_229 , _sage_const_233 , _sage_const_239 , _sage_const_241 , _sage_const_251 ]

    for i in primes:
        try:
            out = long_to_bytes(franklinReiter(n, e, i, c1, c2)).decode()
            if out.startswith("password:"):
                return(out)
        except:
            print("",end="")


print(f"lvl1 {lvl1()}")
print(f"lvl2 {lvl4()}")
print(f"lvl3 {lvl3()}")
print(f"lvl4 {lvl2()}")
print(f"lvl5 {lvl5()}")

